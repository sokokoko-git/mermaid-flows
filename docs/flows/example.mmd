flowchart LR
  %% レイアウト前提：左→右に流し、右下で梱包完了
  %% 在庫/WIP上限制約は[ ]内に表記

  A[組み立て前在庫\n[上限:160]] --> B((組み立て))
  B --> C[組み立て後在庫\n[上限:9]]

  %% 寸法検査
  C --> D{寸法検査}
  D -->|OK| E{外観検査}
  D -->|NG| D1[(寸法修正)]
  D1 --> D

  %% 外観検査
  E -->|OK| F((清掃))
  E -->|NG| E1[(外観修正)]
  E1 --> E

  %% 清掃と在庫
  F --> G[清掃済み在庫\n[上限:1]]

  %% 梱包工程（5脚/箱）
  G --> H((梱包: 5脚/箱))
  H --> I[梱包中在庫\n[上限:5]]
  I --> J[梱包済み在庫]

  %% 付記：組立中はスタッキング禁止（工程内WIPは単品管理）
  classDef store fill:#f6f6f6,stroke:#888,stroke-width:1px;
  classDef proc fill:#e8f4ff,stroke:#268bd2,stroke-width:1.5px;
  classDef gate fill:#fffbe6,stroke:#b58900,stroke-width:1.5px;
  classDef fix fill:#fff0f0,stroke:#dc322f,stroke-width:1.5px,stroke-dasharray:3 2;

  class A,C,G,I,J store;
  class B,F,H proc;
  class D,E gate;
  class D1,E1 fix;
