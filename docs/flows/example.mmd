flowchart LR
  %% GitHub向け：[]の入れ子を避け、改行は <br/> を使用

  A[組み立て前在庫<br/>上限:160] --> B(組み立て)
  B --> C[組み立て後在庫<br/>上限:9]

  %% 組み立て後に清掃を追加
  C --> C1(清掃)
  C1 --> D{寸法検査}

  D -->|OK| E{外観検査}
  D -->|NG| D1[寸法修正]
  %% 修正品は組み立て後在庫へ戻す
  D1 --> C

  E -->|OK| F(清掃)
  E -->|NG| E1[外観修正]
  %% 修正品は組み立て後在庫へ戻す
  E1 --> C

  F --> G[清掃済み在庫<br/>上限:1]

  %% 清掃済み在庫の後に写真撮影工程（特例）を追加
  G --> G1[写真撮影（検証中）]
  G1 --> H(梱包 5脚/箱)

  H --> I[梱包中在庫<br/>上限:5]
  I --> J[梱包済み在庫]

  %% スタイル定義
  classDef store fill:#f6f6f6,stroke:#888,stroke-width:1px;
  classDef proc fill:#e8f4ff,stroke:#268bd2,stroke-width:1.5px;
  classDef gate fill:#fffbe6,stroke:#b58900,stroke-width:1.5px;
  classDef fix fill:#fff0f0,stroke:#dc322f,stroke-width:1.5px,stroke-dasharray:3 2;
  classDef special fill:#e0ffe0,stroke:#2aa198,stroke-width:1.5px,stroke-dasharray:5 3;

  class A,C,G,I,J store;
  class B,C1,F,H proc;
  class D,E gate;
  class D1,E1 fix;
  class G1 special;
